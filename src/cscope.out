cscope 15 /opt/resource/linux-adk/src -q 0000000336 0000040049
	@/opt/resource/linux-adk/src/accessory.c

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<°dlib.h
>

24 
	~<uni°d.h
>

25 
	~<°rög.h
>

27 
	~<libusb.h
>

29 
	~"löux-adk.h
"

30 
	~"hid.h
"

32 
	gvÆid_mou£_ªp‹t_des¸ùt‹
 [] =

89 
	$ac˚ss‹y_maö
(
ac˚ss‹y_t
 * 
acc
)

91 
ªt
 = 0;

92 
hid_devi˚
 
hid
;

111 if(
	`£¨ch_hid
(&
hid
, 
acc
) == 0) {

112 
	`ªgi°î_hid_ˇŒback
(
acc
, &
hid
);

113 
	`£nd_hid_des¸ùt‹
(
acc
, &
hid
);

118 if(
	`£¨ch_hid
(&
hid
) == 0) {

119 
	`ªgi°î_hid_ˇŒback
(
acc
, &
hid
);

121 
	`£t_hid_logiˇl_ønge
(1080,1920);

122 
	`£t_hid_physiˇl_ønge
(0,0);

123 
	`£nd_hid_des¸ùt‹
(
acc
, &
hid
);

128 i‡((
acc
->
pid
 !
AOA_AUDIO_ADB_PID
Ë&& (acc->pid !
AOA_AUDIO_PID
)) {

129 
uöt8_t
 
acc_buf
[512];

130 
å™s„ºed
, 
i
;

131 
îr‹s
 = 20;

133 
	`¥ötf
("detach..\n");

134 
	`libusb_£t_auto_dëach_kî√l_drivî
(
acc
->
h™dÀ
,1);

137 
	`u¶ìp
(10000);

138 
	`¥ötf
("claiming ...\n");

141 
ªt
 =

142 
	`libusb_˛aim_öãrÁ˚
(
acc
->
h™dÀ
,

143 
AOA_ACCESSORY_INTERFACE
);

144 i‡(
ªt
 != 0) {

145 
	`¥ötf
("Eº‹ %d cœimög i¡îÁ˚...\n", 
ªt
);

149 
	`¥ötf
("SnoopingÜoop\n");

151 
t
 = 0;

153 !
°›_acc
) {

154 
	`mem£t
(
acc_buf
,++
t
 % 512,(acc_buf));

156 
ªt
 =

157 
	`libusb_bulk_å™s„r
(
acc
->
h™dÀ
,

158 
AOA_ACCESSORY_EP_OUT
, 
acc_buf
,

159 (
acc_buf
), &
å™s„ºed
,

161 
	`¥ötf
("EP_OUTÑë(%d)\n",
ªt
);

163 
ªt
 =

164 
	`libusb_bulk_å™s„r
(
acc
->
h™dÀ
,

166 
AOA_ACCESSORY_EP_IN
, 
acc_buf
,

167 (
acc_buf
), &
å™s„ºed
,

170 i‡(
ªt
 < 0) {

171 i‡(
ªt
 =
LIBUSB_ERROR_TIMEOUT
) {

172 
	`¥ötf
("timeout...\n");

175 
	`¥ötf
("bulkÅøns„∏îr‹ %d\n", 
ªt
);

176 i‡(--
îr‹s
 == 0)

179 
	`¶ìp
(1);

184 
	`¥ötf
("Re˚ived %d byãs\n", 
å™s„ºed
);

185 
i
 = 0; i < 
å™s„ºed
;) {

186 
	`¥ötf
("%#2.2x ", 
acc_buf
[
i
++]);

187 i‡(!(
i
 % 8))

188 
	`¥ötf
("\n");

190 
	`¥ötf
("\n");

195 i‡((
acc
->
pid
 >
AOA_AUDIO_PID
Ë&& (
hid
.
h™dÀ
))

196 
	`±hªad_joö
(
hid
.
rx_thªad
, 
NULL
);

197 
	}
}

	@/opt/resource/linux-adk/src/axis.c

8 
	~<°dio.h
>

9 
	~<m©h.h
>

10 
	~<löux/öput.h
>

11 
	~"axis.h
"

13 
AxisSëtög
* 
	g£tup
;

14 
	grŸ
;

15 
	gcos_vÆ
 = -1;

16 
	gsö_vÆ
 = -1;

23 
	$axis_öô
(
AxisSëtög
* 
as
 , 
™gÀ
)

25 if(
as
 =
NULL
 && (
™gÀ
 % 90)!= 0) {

28 
£tup
 = 
as
;

29 
rŸ
 = 
™gÀ
;

30 
sö_vÆ
 = 
	`sö
(()(2* 
PI
 * 
™gÀ
 / 360));

31 
cos_vÆ
 = 
	`cos
(()(2* 
PI
 * 
™gÀ
 / 360));

44 
	}
}

47 
Poöt
 
	$axis_c⁄vît
(
Poöt
 
p
)

49 
Poöt
 
ªt
;

50 
x
,
y
;

52 if((
p
.
x
 - 
£tup
->
css
.
ba£_x
 ) > sëup->css.
võw_width
)

53 
p
.
x
 = 
£tup
->
css
.
võw_width
;

54 if((
p
.
y
 - 
£tup
->
css
.
ba£_y
 ) > sëup->css.
võw_height
)

55 
p
.
y
 = 
£tup
->
css
.
võw_height
;

58 
x
 = 
cos_vÆ
 * 
p
.x + 
sö_vÆ
 *Ö.
y
;

59 
y
 = 
cos_vÆ
 * 
p
.y - 
sö_vÆ
 *Ö.
x
;

63 
rŸ
) {

66 
y
 = y - 
£tup
->
css
.
ba£_x
 + sëup->css.
fuŒ_width
;

67 
x
 = x - 
£tup
->
css
.
ba£_y
;

69 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_height
;

70 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_width
;

74 
x
 = x - 
£tup
->
css
.
ba£_y
 + sëup->css.
fuŒ_height
;

75 
y
 = y - 
£tup
->
css
.
ba£_x
;

77 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_height
;

78 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_width
;

82 
x
 = x - 
£tup
->
css
.
ba£_x
 + sëup->css.
fuŒ_width
;

83 
y
 = y - 
£tup
->
css
.
ba£_y
 + sëup->css.
fuŒ_height
;

85 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_width
;

86 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_height
;

90 
x
 = x - 
£tup
->
css
.
ba£_x
;

91 
y
 = y - 
£tup
->
css
.
ba£_y
;

93 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_width
;

94 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_height
;

97 
	`¥ötf
("unsupportedÑot\n");

101 
ªt
.
x
 = ()x;

102 
ªt
.
y
 = ()y;

103  
ªt
;

104 
	}
}

106 
Poöt
 
	$axis_c⁄vît
(
Poöt
 
p
)

108 
Poöt
 
ªt
;

109 
ªt
.
x
 = -1;

110 
ªt
.
y
 = -1;

111 
x1
,
y1
;

112 
x
,
y
;

114 if((
p
.
x
 - 
£tup
->
css
.
ba£_x
 ) > sëup->css.
võw_width
)

115  
ªt
;

116 if((
p
.
y
 - 
£tup
->
css
.
ba£_y
 ) > sëup->css.
võw_height
)

117  
ªt
;

120 
x
 = 
p
.x - 
£tup
->
css
.
ba£_x
;

121 
y
 = 
p
.y - 
£tup
->
css
.
ba£_y
;

125 
x1
 = ()(
cos_vÆ
 * 
x
 + 
sö_vÆ
 * 
y
);

126 
y1
 = ()(
cos_vÆ
 * 
y
 - 
sö_vÆ
 * 
x
);

128 
x
 = 
x1
;

129 
y
 = 
y1
;

132 
rŸ
){

135 
y
 = y + 
£tup
->
css
.
võw_width
;

136 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_height
;

137 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_width
;

141 
x
 = x + 
£tup
->
css
.
võw_height
;

142 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_height
;

143 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_width
;

147 
x
 = x + 
£tup
->
css
.
võw_width
;

148 
y
 = y + 
£tup
->
css
.
võw_height
;

149 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_width
;

150 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_height
;

154 
x
 = x * 
£tup
->
pss
.
fuŒ_width
 / sëup->
css
.
võw_width
;

155 
y
 = y * 
£tup
->
pss
.
fuŒ_height
 / sëup->
css
.
võw_height
;

158 
	`¥ötf
("not supportedÑot\n");

162 
ªt
.
x
 = ()x;

163 
ªt
.
y
 = ()y;

166  
ªt
;

167 
	}
}

176 
wrôe_evít
(
fd
, 
ty≥
, 
code
, 
vÆue
);

177 
EVENT_INFO
 
ei
;

179 
	$axis_öje˘
(
a˘i⁄
, 
Poöt
 
p
)

181 
x
 = 
p
.x;

182 
y
 = 
p
.y;

183 
a˘i⁄
) {

184 
TOUCH_DOWN
:

196 
	`wrôe_evít
(
ei
.
fd_touch
, 
EV_ABS
, 
ABS_MT_TRACKING_ID
, 0x1b3a);

197 
	`wrôe_evít
(
ei
.
fd_touch
,
EV_KEY
,
BTN_TOUCH
,1);

198 
	`wrôe_evít
(
ei
.
fd_touch
,
EV_ABS
,
ABS_MT_POSITION_X
,
x
);

199 
	`wrôe_evít
(
ei
.
fd_touch
,
EV_ABS
,
ABS_MT_POSITION_Y
,
y
);

200 
	`wrôe_evít
(
ei
.
fd_touch
,
EV_ABS
,
ABS_MT_PRESSURE
,0x3e);

201 
	`wrôe_evít
(
ei
.
fd_touch
,0,0,0);

208 
TOUCH_UP
:

213 
	`wrôe_evít
(
ei
.
fd_touch
, 
EV_ABS
, 
ABS_MT_TRACKING_ID
, -1);

214 
	`wrôe_evít
(
ei
.
fd_touch
,
EV_KEY
, 
BTN_TOUCH
, 0);

215 
	`wrôe_evít
(
ei
.
fd_touch
, 0, 0, 0);

218 
TOUCH_MOVE
:

224 
	`wrôe_evít
(
ei
.
fd_touch
, 
EV_ABS
, 
ABS_MT_POSITION_X
, 
x
);

225 
	`wrôe_evít
(
ei
.
fd_touch
, 
EV_ABS
, 
ABS_MT_POSITION_Y
, 
y
);

226 
	`wrôe_evít
(
ei
.
fd_touch
, 
EV_ABS
, 
ABS_MT_PRESSURE
, 0x3d);

227 
	`wrôe_evít
(
ei
.
fd_touch
, 0, 0, 0);

231 
	}
}

240 
	$maö
(* 
¨gv
[] ,
¨gc
) {

242 
AxisSëtög
 
s
;

244 
s
.
css
.
ba£_x
 = 0;

245 
s
.
css
.
ba£_y
 = 0;

247 
s
.
css
.
võw_width
 = 1280;

248 
s
.
css
.
võw_height
 = 800;

250 
s
.
css
.
fuŒ_width
 = 1280;

251 
s
.
css
.
fuŒ_height
 = 800;

253 
s
.
pss
.
fuŒ_width
 = 1200;

254 
s
.
pss
.
fuŒ_height
 = 1600;

255 
Poöt
 
ö
,
out
;

257 
s
.
css
.
ba£_x
 = (1280 - 500)/2;

258 
s
.
css
.
ba£_y
 = 0;

259 
s
.
css
.
võw_width
 = 500;

260 
s
.
css
.
võw_height
 = 800;

262 
s
.
css
.
fuŒ_width
 = 1280;

263 
s
.
css
.
fuŒ_height
 = 800;

265 
s
.
pss
.
fuŒ_width
 = 800;

266 
s
.
pss
.
fuŒ_height
 = 1280;

267 
Poöt
 
ö
,
out
;

269 
œng
 = -1;

270 
™g
 = 90;

272 if(
œng
 !
™g
)

273 
	`axis_öô
(&
s
,
™g
);

275 
	`¥ötf
("input (x,y): ");

276 
	`sˇnf
("%d",&
ö
.
x
);

277 
	`sˇnf
("%d",&
ö
.
y
);

278 
out
 = 
	`axis_c⁄vît
(
ö
);

279 
	`¥ötf
("c⁄vîà(%d,%dËtÿ(%d,%d)\n",
ö
.
x
,ö.
y
,
out
.x,out.y);

281 
œng
 = 
™g
;

285 
	}
}

	@/opt/resource/linux-adk/src/axis.h

8 #i‚de‡
_AXIS_H


9 
	#_AXIS_H


	)

13 
	#PI
 (3.1415926)

	)

16 
	mTOUCH_DOWN
 = 5,

17 
	mTOUCH_MOVE
 = 4,

18 
	mTOUCH_UP
 = 6,

19 } 
	gC¨A˘i⁄
;

23 
	mx
;

24 
	my
;

25 } 
	tPoöt
;

29 
	mba£_x
;

30 
	mba£_y
;

31 
	mvõw_height
;

32 
	mvõw_width
;

33 
	mfuŒ_height
;

34 
	mfuŒ_width
;

35 } 
	tC¨S¸ìnSëtög
;

39 
	mfuŒ_height
;

40 
	mfuŒ_width
;

41 } 
	tPh⁄eS¸ìnSëtög
;

45 
C¨S¸ìnSëtög
 
	mcss
;

46 
Ph⁄eS¸ìnSëtög
 
	mpss
;

47 } 
	tAxisSëtög
 ;

55 
axis_öô
(
AxisSëtög
* 
as
 , 
™gÀ
);

61 
Poöt
 
axis_c⁄vît
(Poöà
p
);

68 
axis_öje˘
(
a˘i⁄
, 
Poöt
 
p
);

	@/opt/resource/linux-adk/src/device.c

2 
	~<libusb-1.0/libusb.h
>

3 
	~<°dio.h
>

4 
	~"löux-adk.h
"

7 
	$∑r£_ídpoöt
(c⁄° 
libusb_ídpoöt_des¸ùt‹
 * 
ídpoöt
)

9 
	`¥ötf
(" Endpoint\n");

10 
	`¥ötf
(" bmAâribuãs: 0x%x\n", 
ídpoöt
->
bmAâribuãs
);

11 
	`¥ötf
(" bEndpoötAddªss: 0x%x\n", 
ídpoöt
->
bEndpoötAddªss
);

13 
	}
}

18 
	$∑r£_Æt£âög
(c⁄° 
libusb_öãrÁ˚_des¸ùt‹
 *
öãrÁ˚
)

20 
i
;

22 
	`¥ötf
(" Interface:\n");

23 
	`¥ötf
(" bI¡îÁ˚Numbî: %d\n", 
öãrÁ˚
->
bI¡îÁ˚Numbî
);

24 
	`¥ötf
(" bA…î«ãSëtög: %d\n", 
öãrÁ˚
->
bA…î«ãSëtög
);

25 
	`¥ötf
(" bNumEndpoöts: %d\n", 
öãrÁ˚
->
bNumEndpoöts
);

26 
	`¥ötf
(" bI¡îÁ˚Cœss: %d\n", 
öãrÁ˚
->
bI¡îÁ˚Cœss
);

27 
	`¥ötf
(" bI¡îÁ˚SubCœss: %d\n", 
öãrÁ˚
->
bI¡îÁ˚SubCœss
);

28 
	`¥ötf
(" bI¡îÁ˚PrŸocﬁ: %d\n", 
öãrÁ˚
->
bI¡îÁ˚PrŸocﬁ
);

29 
	`¥ötf
(" iI¡îÁ˚: %d\n", 
öãrÁ˚
->
iI¡îÁ˚
);

33 if–
öãrÁ˚
->
bI¡îÁ˚Cœss
 == 255 &&

34 
öãrÁ˚
->
bI¡îÁ˚SubCœss
 == 66 &&

35 
öãrÁ˚
->
bI¡îÁ˚PrŸocﬁ
 == 1) {

36 
	`¥ötf
("AndroidÜinkáttached\n");

40 if–
öãrÁ˚
->
bI¡îÁ˚Cœss
 == 255 &&

41 
öãrÁ˚
->
bI¡îÁ˚SubCœss
 == 254 &&

42 
öãrÁ˚
->
bI¡îÁ˚PrŸocﬁ
 == 2) {

45 
i
 = 0; i < 
öãrÁ˚
->
bNumEndpoöts
; i++)

46 
	`∑r£_ídpoöt
(&
öãrÁ˚
->
ídpoöt
[
i
]);

48 
	}
}

56 
	$∑r£_öãrÁ˚
(c⁄° 
libusb_öãrÁ˚
 *
öãrÁ˚
)

58 
ªt
;

59 
i
;

61 
i
 = 0; i < 
öãrÁ˚
->
num_Æt£âög
; i++) {

62 
ªt
 = 
	`∑r£_Æt£âög
(&
öãrÁ˚
->
Æt£âög
[
i
]);

63 if(
ªt
 == 2) Ñet;

66 
	}
}

73 
	$∑r£_c⁄figuøti⁄
(
libusb_c⁄fig_des¸ùt‹
 *
c⁄fig
)

75 
i
;

76 
ªt
;

78 
	`¥ötf
(" Configuration:\n");

79 
	`¥ötf
(" wTŸÆLígth: %d\n", 
c⁄fig
->
wTŸÆLígth
);

80 
	`¥ötf
(" bNumI¡îÁ˚s: %d\n", 
c⁄fig
->
bNumI¡îÁ˚s
);

81 
	`¥ötf
(" bC⁄figuøti⁄VÆue: %d\n", 
c⁄fig
->
bC⁄figuøti⁄VÆue
);

82 
	`¥ötf
(" iC⁄figuøti⁄: %d\n", 
c⁄fig
->
iC⁄figuøti⁄
);

83 
	`¥ötf
(" bmAâribuãs: %02xh\n", 
c⁄fig
->
bmAâribuãs
);

84 
	`¥ötf
(" MaxPowî: %d\n", 
c⁄fig
->
MaxPowî
);

87 
i
 = 0; i < 
c⁄fig
->
bNumI¡îÁ˚s
; i++) {

88 
ªt
 = 
	`∑r£_öãrÁ˚
(&
c⁄fig
->
öãrÁ˚
[
i
]);

89 if(
ªt
 == 2) Ñet;

93 
	}
}

100 
	$∑r£_devs
(
vid
)

102 
libusb_devi˚
 **
devs
;

103 
libusb_devi˚_des¸ùt‹
 
desc
;

104 
libusb_c⁄fig_des¸ùt‹
 *
c⁄fig
;

105 
ssize_t
 
˙t
;

106 
ªt
, 
i
;

108 
ªt
 = 
	`libusb_öô
(
NULL
);

109 i‡(
ªt
 < 0)

110  
ªt
;

112 
˙t
 = 
	`libusb_gë_devi˚_li°
(
NULL
, &
devs
);

113 i‡(
˙t
 < 0)

114  ()
˙t
;

116 
i
 = 0; 
devs
[i]; ++i) {

118 
ªt
 = 
	`libusb_gë_devi˚_des¸ùt‹
(
devs
[
i
], &
desc
);

119 i‡(
ªt
 < 0) {

120 
	`¥ötf
( "failedÅo get device descriptori\n");

124 
	`¥ötf
("devi˚áâached: %04x:%04x\n", 
desc
.
idVíd‹
, desc.
idProdu˘
);

125 if(
vid
 =0 || 
desc
.
idVíd‹
 == vid ) {

126 
	`¥ötf
("vid(0x%xË©èched \n",
desc
.
idVíd‹
);

127 
ªt
 = 
	`libusb_gë_a˘ive_c⁄fig_des¸ùt‹
(
devs
[
i
], &
c⁄fig
);

128 i‡(
ªt
 !
LIBUSB_SUCCESS
) {

129 
	`¥ötf
("FailedÜibusb_get_active_config_descriptor\n");

130 
ªt
 = -1;

131 
EXIT
;

133 
ªt
 = 
	`∑r£_c⁄figuøti⁄
(
c⁄fig
);

137 
EXIT
:

138 
	`libusb_‰ì_devi˚_li°
(
devs
, 1);

139  
ªt
;

140 
	}
}

148 
	$›í_•ecül_vid_dev
(
vid
, 
ac˚ss‹y_t
 * 
acc
)

150 
libusb_devi˚
 **
devs
;

151 
libusb_devi˚_h™dÀ
 *
h™dÀ
;

152 
libusb_devi˚_des¸ùt‹
 
desc
;

153 
libusb_c⁄fig_des¸ùt‹
 *
c⁄fig
;

154 
ssize_t
 
˙t
;

155 
ªt
, 
i
;

161 
˙t
 = 
	`libusb_gë_devi˚_li°
(
NULL
, &
devs
);

162 i‡(
˙t
 < 0)

163  ()
˙t
;

165 
i
 = 0; 
devs
[i]; ++i) {

167 
ªt
 = 
	`libusb_gë_devi˚_des¸ùt‹
(
devs
[
i
], &
desc
);

168 i‡(
ªt
 < 0) {

169 
	`¥ötf
( "failedÅo get device descriptori\n");

173 
	`¥ötf
("devi˚áâached: %04x:%04x\n", 
desc
.
idVíd‹
, desc.
idProdu˘
);

174 if(
desc
.
idVíd‹
 =
vid
 ) {

175 
	`¥ötf
("vid(0x%xË©èched \n",
desc
.
idVíd‹
);

176 
ªt
 = 
	`libusb_gë_a˘ive_c⁄fig_des¸ùt‹
(
devs
[
i
], &
c⁄fig
);

177 i‡(
ªt
 !
LIBUSB_SUCCESS
) {

178 
	`¥ötf
("FailedÜibusb_get_active_config_descriptor\n");

179 
ªt
 = -1;

180 
EXIT
;

182 
ªt
 = 
	`∑r£_c⁄figuøti⁄
(
c⁄fig
);

184 
	`libusb_ªf_devi˚
(
devs
[
i
]);

185 
ªt
 = 
	`libusb_›í
(
devs
[
i
],&
h™dÀ
);

186 i‡(
ªt
 !
LIBUSB_SUCCESS
) {

187 
	`¥ötf
–"FaûedÜibusb_›í(%d)\n",
ªt
);

188 
ªt
 = -1;

189 
EXIT
;

191 
acc
->
h™dÀ
 = handle;

192 
	`¥ötf
( "OKÜibusb_open get handle\n");

198 
EXIT
:

199 
	`libusb_‰ì_devi˚_li°
(
devs
, 1);

200  
ªt
;

201 
	}
}

	@/opt/resource/linux-adk/src/hid.c

23 
	~<°dio.h
>

24 
	~<°rög.h
>

25 
	~<°dlib.h
>

26 
	~<°döt.h
>

27 
	~<uni°d.h
>

28 
	~<pﬁl.h
>

29 
	~<libusb.h
>

31 
	~"löux-adk.h
"

32 
	~"hid.h
"

33 
	~"axis.h
"

35 
	#REPORT_ID
 (4)

	)

38 
	#PHONE_WIDTH
 (1080)

	)

39 
	#PHONE_HEIGHT
 (1920)

	)

41 #if(
TOUCHSCREEN_ENABLE
 == 1)

42 
	ghid_ªp‹t_desc
[] = {

47 0x85, 
REPORT_ID
,

100 
	sRï‹t
 {

101 
	mªp‹t_id
 ;

103 
	mbTùSwôch
 : 1;

104 
	mbInR™ge
 : 1;

105 
	mª£rved
 : 6;

106 } 
	m°©us
;

107 
	mwXD©a
;

108 
	mwYD©a
;

110 #ñi‡(
TOUCHSCREEN_ENABLE
 == 2)

112 
	#LOGICAL_MINIMUM_1
 (0x15)

	)

113 
	#LOGICAL_MAXIMUM_1
 (0x25)

	)

114 
	#LOGICAL_MINIMUM_2
 (0x16)

	)

115 
	#LOGICAL_MAXIMUM_2
 (0x26)

	)

118 
	#PHYSICAL_MINIMUM_1
 (0x35)

	)

119 
	#PHYSICAL_MAXIMUM_1
 (0x45)

	)

120 
	#PHYSICAL_MINIMUM_2
 (0x36)

	)

121 
	#PHYSICAL_MAXIMUM_2
 (0x46)

	)

123 
	ghid_ªp‹t_desc
[] = {

127 0x85, 
REPORT_ID
,

154 
LOGICAL_MINIMUM_2
, 0x00,0xF8,

155 
LOGICAL_MAXIMUM_2
, 0x00,0x08,

156 
PHYSICAL_MINIMUM_2
, 0x00,0xF8,

157 
PHYSICAL_MAXIMUM_2
, 0x00,0x08,

163 
LOGICAL_MINIMUM_2
, 0x00,0xFC,

164 
LOGICAL_MAXIMUM_2
, 0x00,0x04,

165 
PHYSICAL_MINIMUM_2
, 0x00,0xF8,

166 
PHYSICAL_MAXIMUM_2
, 0x00,0x08,

176 
	sRï‹t
 {

177 
	mªp‹t_id
 ;

179 
	mbTùSwôch
 : 1;

180 
	mbInR™ge
 : 1;

181 
	mª£rved
 : 6;

182 } 
	m°©us
;

183 
	mwXD©a
;

184 
	mwYD©a
;

189 
	$£t_hid_logiˇl_ønge
(
width
, 
height
)

191 * 
tmp
 = 
hid_ªp‹t_desc
;

192 
lb_w
 = 0;

193 
ub_w
 = 
width
;

194 
lb_h
 = 0;

195 
ub_h
 = 
height
;

196 
i
;

198 
STEP_1
,

199 
STEP_2
,

200 
STEP_3
,

201 
STEP_4
,

202 } 
	t_STEP
;

203 
°ï
 = 
STEP_1
;

204 
i
 = 0 ; i < (
hid_ªp‹t_desc
); i++) {

206 
°ï
) {

207 
STEP_1
:

208 if(
tmp
[
i
] =
LOGICAL_MINIMUM_2
) {

209 
tmp
[
i
+1] = 
lb_w
 & 0x00FF;

210 
tmp
[
i
+2] = (
lb_w
 & 0xFF00) >> 8;

211 
	`¥ötf
("lb_w vÆ(%dË=(0x%02x 0x%02x)",
lb_w
,
tmp
[
i
+1],tmp[i+2]);

212 
°ï
 = 
STEP_2
;

215 
STEP_2
:

216 if(
tmp
[
i
] =
LOGICAL_MAXIMUM_2
) {

217 
tmp
[
i
+1] = 
ub_w
 & 0x00FF;

218 
tmp
[
i
+2] = (
ub_w
 & 0xFF00) >> 8;

219 
	`¥ötf
("ub_w vÆ(%dË=(0x%02x 0x%02x)",
ub_w
,
tmp
[
i
+1],tmp[i+2]);

220 
°ï
 = 
STEP_3
;

223 
STEP_3
:

224 if(
tmp
[
i
] =
LOGICAL_MINIMUM_2
) {

225 
tmp
[
i
+1] = 
lb_h
 & 0x00FF;

226 
tmp
[
i
+2] = (
lb_h
 & 0xFF00) >> 8;

227 
	`¥ötf
("lb_h vÆ(%dË=(0x%02x 0x%02x)\n",
lb_h
,
tmp
[
i
+1],tmp[i+2]);

228 
°ï
 = 
STEP_4
;

231 
STEP_4
:

233 if(
tmp
[
i
] =
LOGICAL_MAXIMUM_2
) {

234 
tmp
[
i
+1] = 
ub_h
 & 0x00FF;

235 
tmp
[
i
+2] = (
ub_h
 & 0xFF00) >> 8;

236 
	`¥ötf
("ub_h vÆ(%dË=(0x%02x 0x%02x)\n",
ub_h
,
tmp
[
i
+1],tmp[i+2]);

237 
íd
;

242 
íd
:

244 
	`¥ötf
("hidÑeport is:\n");

245 
i
 = 0 ; i < (
hid_ªp‹t_desc
) ;i++) {

246 
	`¥ötf
("0x%02x ",
tmp
[
i
]);

247 if(
i
 % 10 == 0)

248 
	`¥ötf
("\n");

250 
	`¥ötf
("\n");

251 
	}
}

253 
	$£t_hid_physiˇl_ønge
(
width
, 
height
)

255 * 
tmp
 = 
hid_ªp‹t_desc
;

256 
lb_w
 = 0;

257 
ub_w
 = 
width
;

258 
lb_h
 = 0;

259 
ub_h
 = 
height
;

260 
i
;

262 
STEP_1
,

263 
STEP_2
,

264 
STEP_3
,

265 
STEP_4
,

266 } 
	t_STEP
;

267 
°ï
 = 
STEP_1
;

268 
i
 = 0 ; i < (
hid_ªp‹t_desc
); i++) {

270 
°ï
) {

271 
STEP_1
:

272 if(
tmp
[
i
] =
PHYSICAL_MINIMUM_2
) {

273 
tmp
[
i
+1] = 
lb_w
 & 0x00FF;

274 
tmp
[
i
+2] = (
lb_w
 & 0xFF00) >> 8;

275 
	`¥ötf
("lb_w vÆ(%dË=(0x%02x 0x%02x)",
lb_w
,
tmp
[
i
+1],tmp[i+2]);

276 
°ï
 = 
STEP_2
;

279 
STEP_2
:

280 if(
tmp
[
i
] =
PHYSICAL_MAXIMUM_2
) {

281 
tmp
[
i
+1] = 
ub_w
 & 0x00FF;

282 
tmp
[
i
+2] = (
ub_w
 & 0xFF00) >> 8;

283 
	`¥ötf
("ub_w vÆ(%dË=(0x%02x 0x%02x)",
ub_w
,
tmp
[
i
+1],tmp[i+2]);

284 
°ï
 = 
STEP_3
;

287 
STEP_3
:

288 if(
tmp
[
i
] =
PHYSICAL_MINIMUM_2
) {

289 
tmp
[
i
+1] = 
lb_h
 & 0x00FF;

290 
tmp
[
i
+2] = (
lb_h
 & 0xFF00) >> 8;

291 
	`¥ötf
("lb_h vÆ(%dË=(0x%02x 0x%02x)\n",
lb_h
,
tmp
[
i
+1],tmp[i+2]);

292 
°ï
 = 
STEP_4
;

295 
STEP_4
:

296 if(
tmp
[
i
] =
PHYSICAL_MAXIMUM_2
) {

297 
tmp
[
i
+1] = 
ub_h
 & 0x00FF;

298 
tmp
[
i
+2] = (
ub_h
 & 0xFF00) >> 8;

299 
	`¥ötf
("ub_h vÆ(%dË=(0x%02x 0x%02x)\n",
ub_h
,
tmp
[
i
+1],tmp[i+2]);

300 
íd
;

305 
íd
:

307 
	`¥ötf
("hidÑeport is:\n");

308 
i
 = 0 ; i < (
hid_ªp‹t_desc
) ;i++) {

309 
	`¥ötf
("0x%02x ",
tmp
[
i
]);

310 if(
i
 % 10 == 0)

311 
	`¥ötf
("\n");

313 
	`¥ötf
("\n");

314 
	}
}

317 *
	$ª˚ive_lo›
(*
¨g
)

319 !
°›_acc
) {

320 
ªt
 = 0;

321 
i
;

322 
nfds
 = 1;

323 
timevÆ
 
tv
, 
zîo_tv
;

324 c⁄° 
libusb_pﬁlfd
 **
pﬁl_li°
;

325 
fd_£t
 
rfds
, 
wfds
, 
efds
;

326 
tv
.
tv_£c
 = 0;

327 
tv
.
tv_u£c
 = 0;

328 
zîo_tv
.
tv_£c
 = 0;

329 
zîo_tv
.
tv_u£c
 = 0;

331 
ªt
 = 
	`libusb_gë_√xt_timeout
(
NULL
, &
tv
);

332 i‡(
ªt
 < 0) {

333 i‡(
ªt
)

334 
	`¥ötf
("USBÉrror : %s\n",

335 
	`libusb_îr‹_«me
(
ªt
));

339 i‡(
ªt
 =1 && 
tv
.
tv_£c
 =0 &&Åv.
tv_u£c
 == 0) {

340 
ªt
 = 
	`libusb_h™dÀ_evíts_timeout_com∂ëed
(
NULL
,

341 &
zîo_tv
,

342 
NULL
);

343 i‡(
ªt
) {

344 i‡(
ªt
)

345 
	`¥ötf
("USBÉrror : %s\n",

346 
	`libusb_îr‹_«me
(
ªt
));

352 
	`FD_ZERO
(&
rfds
);

353 
	`FD_ZERO
(&
wfds
);

354 
	`FD_ZERO
(&
efds
);

355 
	`FD_SET
(0, &
rfds
);

356 
pﬁl_li°
 = 
	`libusb_gë_pﬁlfds
(
NULL
);

357 i‡(
pﬁl_li°
) {

358 
i
 = 0; 
pﬁl_li°
[i] !
NULL
; i++) {

359 c⁄° 
libusb_pﬁlfd
 *
cur_pﬁl
;

361 
cur_pﬁl
 = 
pﬁl_li°
[
i
];

362 
nfds
 = 
cur_pﬁl
->
fd
 >=Çfds

363 ? 
cur_pﬁl
->
fd
 + 1 : 
nfds
;

364 i‡(
cur_pﬁl
->
evíts
 & 
POLLIN
)

365 
	`FD_SET
(
cur_pﬁl
->
fd
, &
rfds
);

366 i‡(
cur_pﬁl
->
evíts
 & 
POLLOUT
)

367 
	`FD_SET
(
cur_pﬁl
->
fd
, &
wfds
);

369 
	`‰ì
(
pﬁl_li°
);

373 i‡(
tv
.
tv_£c
 =0 &&Åv.
tv_u£c
 == 0)

374 
ªt
 = 
	`£À˘
(
nfds
, &
rfds
, &
wfds
, &
efds
, 
NULL
);

376 
ªt
 = 
	`£À˘
(
nfds
, &
rfds
, &
wfds
, &
efds
, &
tv
);

378 i‡(
libusb_h™dÀ_evíts_timeout_com∂ëed


379 (
NULL
, &
zîo_tv
, NULL))

383  
NULL
;

384 
	}
}

386 
	$›í_devi˚
(
libusb_devi˚_h™dÀ
 **
h™dÀ
,

387 
libusb_devi˚
 * 
devi˚
, 
öãrÁ˚
)

389 
kî√l_˛aimed
 = 0, 
ªt
;

391 
	`libusb_ªf_devi˚
(
devi˚
);

392 
ªt
 = 
	`libusb_›í
(
devi˚
, 
h™dÀ
);

393 i‡(
ªt
) {

394 
	`¥ötf
("U«bÀÅÿ›í usb devi˚ [%#08x]\n", 
ªt
);

395 *
h™dÀ
 = 
NULL
;

399 
	`¥ötf
("libusb_kernel_driver_active\n");

400 
ªt
 = 
	`libusb_kî√l_drivî_a˘ive
(*
h™dÀ
, 
öãrÁ˚
);

401 i‡(
ªt
 == 1) {

402 i‡(
	`libusb_dëach_kî√l_drivî
(*
h™dÀ
, 
öãrÁ˚
)) {

403 
	`¥ötf
("UnableÅo grab usb device\n");

404 
	`libusb_˛o£
(*
h™dÀ
);

405 *
h™dÀ
 = 
NULL
;

408 
kî√l_˛aimed
 = 1;

411 
	`¥ötf
("libusb_claim_interface\n");

412 
ªt
 = 
	`libusb_˛aim_öãrÁ˚
(*
h™dÀ
, 
öãrÁ˚
);

413 i‡(
ªt
) {

414 
	`¥ötf
("FaûedÅÿ˛aim i¡îÁ˚ %d.\n", 
öãrÁ˚
);

415 i‡(
kî√l_˛aimed
) {

416 
	`libusb_©èch_kî√l_drivî
(*
h™dÀ
, 
öãrÁ˚
);

417 
kî√l_˛aimed
 = 0;

419 
	`libusb_˛o£
(*
h™dÀ
);

420 *
h™dÀ
 = 
NULL
;

425 
	}
}

427 
	$ˇŒback_hid
(
libusb_å™s„r
 *
å™s„r
)

429 
ac˚ss‹y_t
 *
acc
 = 
å™s„r
->
u£r_d©a
;

430 
rc
 = 0;

432 i‡(
å™s„r
->
°©us
 =
LIBUSB_TRANSFER_COMPLETED
) {

433 
libusb_å™s„r
 *
™droid_å™s„r
;

434 *
keybuf
;

435 
rc
;

437 
™droid_å™s„r
 = 
	`libusb_Æloc_å™s„r
(0);

439 
s
 = 0;

441 
	`¥ötf
("orig hidÑeport data from mouse:\n");

442 
s
 = 0 ; s < 
å™s„r
->
a˘uÆ_Àngth
; s ++) {

443 
	`¥ötf
("0x%02x ",
å™s„r
->
buf„r
[
s
]);

445 
	`¥ötf
("\n");

447 #if(
TOUCHSCREEN_ENABLE
 == 1)

448 
å™s„r
->
a˘uÆ_Àngth
 = (
Rï‹t
);

453 
cou¡s
 = 0;

455 
Rï‹t
 
ªp‹t
;

456 
ªp‹t
.
ªp‹t_id
 = 
REPORT_ID
;

457 if(
cou¡s
 != 0) {

458 
ªp‹t
.
wXD©a
 = 
cou¡s
 % 1080;

459 
ªp‹t
.
wYD©a
 = 
cou¡s
 * 1920 / 1080 % 1920 ;

461 
ªp‹t
.
wXD©a
 =Ñï‹t.
wYD©a
 = 0;

463 if(
ªp‹t
.
wXD©a
 >= 200 &&Ñeport.wXData <= 900)

464 
ªp‹t
.
°©us
.
bTùSwôch
 = 1;

466 
ªp‹t
.
°©us
.
bTùSwôch
 = 0;

467 
cou¡s
 ++;

471 
å™s„r
->
buf„r
 = (*)&
ªp‹t
;

472 #ñi‡(
TOUCHSCREEN_ENABLE
 == 2)

473 
å™s„r
->
a˘uÆ_Àngth
 = (
Rï‹t
);

478 
cou¡s
 = 0;

480 
Rï‹t
 
ªp‹t
;

481 
ªp‹t
.
ªp‹t_id
 = 
REPORT_ID
;

482 if(
cou¡s
 != 0) {

483 
ªp‹t
.
wXD©a
 = 
cou¡s
 * 4 % 
PHONE_HEIGHT
;

484 
ªp‹t
.
wYD©a
 = 
cou¡s
 * 4 % 
PHONE_WIDTH
 ;

486 
ªp‹t
.
wXD©a
 =Ñï‹t.
wYD©a
 = 0;

488 if(
ªp‹t
.
wXD©a
 >= 200 &&Ñeport.wXData <= 900)

489 
ªp‹t
.
°©us
.
bTùSwôch
 = 1;

491 
ªp‹t
.
°©us
.
bTùSwôch
 = 0;

492 
cou¡s
 ++;

497 
å™s„r
->
buf„r
 = (*)&
ªp‹t
;

499 
keybuf
 = 
	`mÆloc
(
å™s„r
->
a˘uÆ_Àngth
 + 
LIBUSB_CONTROL_SETUP_SIZE
);

500 
	`mem˝y
(
keybuf
 + 
LIBUSB_CONTROL_SETUP_SIZE
, 
å™s„r
->
buf„r
,

501 
å™s„r
->
a˘uÆ_Àngth
);

503 
	`¥ötf
("hidÑeport data:\n");

504 
s
 = 0 ; s < 
å™s„r
->
a˘uÆ_Àngth
; s ++) {

505 
	`¥ötf
("0x%02x ",
å™s„r
->
buf„r
[
s
]);

507 
	`¥ötf
("\n");

510 
	`libusb_fûl_c⁄åﬁ_£tup
(
keybuf
,

511 
LIBUSB_ENDPOINT_OUT
 |

512 
LIBUSB_REQUEST_TYPE_VENDOR
,

513 
AOA_SEND_HID_EVENT
, 1, 0,

514 
å™s„r
->
a˘uÆ_Àngth
);

516 
	`libusb_fûl_c⁄åﬁ_å™s„r
(
™droid_å™s„r
, 
acc
->
h™dÀ
,

517 
keybuf
, 
NULL
, NULL, 0);

519 
™droid_å™s„r
->
Êags
 =

520 
LIBUSB_TRANSFER_FREE_BUFFER
 | 
LIBUSB_TRANSFER_FREE_TRANSFER
;

522 
rc
 = 
	`libusb_submô_å™s„r
(
™droid_å™s„r
);

523 i‡(
rc
)

524 
	`¥ötf
("USBÉº‹ : %s\n", 
	`libusb_îr‹_«me
(
rc
));

526 
rc
 = 
	`libusb_submô_å™s„r
(
å™s„r
);

527 i‡(
rc
)

528 
	`¥ötf
("USBÉº‹ : %s\n", 
	`libusb_îr‹_«me
(
rc
));

530 } i‡(
å™s„r
->
°©us
 =
LIBUSB_TRANSFER_TIMED_OUT
) {

531 
rc
 = 
	`libusb_submô_å™s„r
(
å™s„r
);

532 i‡(
rc
)

533 
	`¥ötf
("USBÉº‹ : %s\n", 
	`libusb_îr‹_«me
(
rc
));

535 
	}
}

537 
	$£¨ch_hid
(
hid_devi˚
 * 
hid
)

539 
libusb_devi˚
 **
li°
;

540 
libusb_devi˚_des¸ùt‹
 
desc
;

541 
ssize_t
 
˙t
;

542 
ssize_t
 
i
 = 0;

543 
j
;

544 
libusb_devi˚
 *
devi˚
;

546 
hid
->
h™dÀ
 = 
NULL
;

549 
˙t
 = 
	`libusb_gë_devi˚_li°
(
NULL
, &
li°
);

550 i‡(
˙t
 < 0)

551 
îr‹0
;

553 
i
 = 0; i < 
˙t
; i++) {

554 
devi˚
 = 
li°
[
i
];

555 
r
;

557 
	`¥ötf
("˙t(%dËi(%dË\n",
˙t
,
i
);

559 
r
 = 
	`libusb_gë_devi˚_des¸ùt‹
(
devi˚
, &
desc
);

560 i‡(
r
 < 0)

563 
	`¥ötf
("desc.bDevi˚Cœs†%d\n",
desc
.
bDevi˚Cœss
);

564 i‡(
desc
.
bDevi˚Cœss
 =
LIBUSB_CLASS_HID
) {

565 
found
;

567 } i‡(
desc
.
bDevi˚Cœss
 =
LIBUSB_CLASS_PER_INTERFACE
) {

568 
libusb_c⁄fig_des¸ùt‹
 *
cuºít_c⁄fig
;

569 
r
;

571 
	`¥ötf
("libusb_get_active_config_descriptor\n");

572 
r
 = 
	`libusb_gë_a˘ive_c⁄fig_des¸ùt‹
(
devi˚
,

573 &
cuºít_c⁄fig
);

574 i‡(
r
 < 0) {

575 
	`¥ötf
("gëá˘ivêdes¯îr‹(%d)",
r
);

578 
	`¥ötf
("parse hid cfg interface\n");

582 
	`¥ötf
("bNumI¡îÁ˚s(%d)\n",
cuºít_c⁄fig
->
bNumI¡îÁ˚s
);

584 
j
 = 0; j < 
cuºít_c⁄fig
->
bNumI¡îÁ˚s
; j++) {

585 
k
;

586 
	`¥ötf
("num_Æt£âög(%d)\n",
cuºít_c⁄fig
->
öãrÁ˚
[
j
].
num_Æt£âög
);

587 
k
 = 0;

588 
k
 <

589 
cuºít_c⁄fig
->

590 
öãrÁ˚
[
j
].
num_Æt£âög
; 
k
++) {

591 i‡(
cuºít_c⁄fig
->

592 
öãrÁ˚
[
j
].
Æt£âög
[
k
].

593 
bI¡îÁ˚Cœss
 ==

594 
LIBUSB_CLASS_HID
) {

595 
hid
->
ídpoöt_ö
 =

596 
cuºít_c⁄fig
->
öãrÁ˚


597 [
j
].

598 
Æt£âög
[
k
].
ídpoöt


599 [0].
bEndpoötAddªss
;

600 
hid
->
∑ckë_size
 =

601 
cuºít_c⁄fig
->
öãrÁ˚


602 [
j
].

603 
Æt£âög
[
k
].
ídpoöt
[0].

604 
wMaxPackëSize
;

605 
	`¥ötf
("£àídpoöt(0x%x)\n",
hid
->
ídpoöt_ö
);

606 
found
;

610 
	`¥ötf
("libusb_free_config_descriptor\n");

611 
	`libusb_‰ì_c⁄fig_des¸ùt‹
(
cuºít_c⁄fig
);

615 
	`¥ötf
("found ...\n");

616 
found
:

617 i‡(
i
 =
˙t
)

618 
îr‹0
;

620 
	`¥ötf
("open_device...\n");

621 i‡(
	`›í_devi˚
(&
hid
->
h™dÀ
, 
devi˚
, 
j
) < 0)

622 
îr‹0
;

625 
	`¥ötf
("GET_DESCRIPTOR...\n");

626 
hid
->
des¸ùt‹_size
 = 
	`libusb_c⁄åﬁ_å™s„r
(hid->
h™dÀ
,

627 
LIBUSB_ENDPOINT_IN
 |

628 
LIBUSB_RECIPIENT_INTERFACE
,

629 
LIBUSB_REQUEST_GET_DESCRIPTOR
,

630 
LIBUSB_DT_REPORT
 << 8, 0,

631 
hid
->
des¸ùt‹
, 256, 0);

632 i‡(
hid
->
des¸ùt‹_size
 < 0)

633 
îr‹1
;

635 
	`libusb_‰ì_devi˚_li°
(
li°
, 1);

636 
	`¥ötf
("=> found HID devi˚ vid 0x%xÖid 0x%x\n", 
desc
.
idVíd‹
,

637 
desc
.
idProdu˘
);

638 
s
 = 0;

639 
	`¥ötf
("descriptor: \n");

640 
s
 = 0 ; s < 
hid
->
des¸ùt‹_size
; s ++) {

641 
	`¥ötf
("0x%02x ",
hid
->
des¸ùt‹
[
s
]);

643 
	`¥ötf
("\n");

646 
îr‹1
:

647 
	`libusb_˛o£
(
hid
->
h™dÀ
);

648 
îr‹0
:

649 
	`libusb_‰ì_devi˚_li°
(
li°
, 1);

651 
	}
}

653 
	$ªgi°î_hid_ˇŒback
(
ac˚ss‹y_t
 * 
acc
, 
hid_devi˚
 * 
hid
)

655 
libusb_å™s„r
 *
hid_å™s„r
;

656 *
keybuf
;

657 
rc
;

659 
AxisSëtög
 
£t
;

660 
£t
.
css
.
ba£_x
 = 0 ;

661 
£t
.
css
.
ba£_y
 = 0 ;

662 
£t
.
css
.
võw_height
 = së.css.
fuŒ_height
 = 
PHONE_WIDTH
 ;

663 
£t
.
css
.
võw_width
 = së.css.
fuŒ_width
 = 
PHONE_HEIGHT
;

665 
£t
.
pss
.
fuŒ_width
 = 
PHONE_HEIGHT
;

666 
£t
.
pss
.
fuŒ_height
 = 
PHONE_WIDTH
;

668 
	`axis_öô
(&
£t
,0);

671 
keybuf
 = 
	`mÆloc
(
hid
->
∑ckë_size
);

673 
hid_å™s„r
 = 
	`libusb_Æloc_å™s„r
(0);

674 i‡(
hid_å™s„r
 =
NULL
) {

675 
	`libusb_˛o£
(
hid
->
h™dÀ
);

679 
	`libusb_fûl_öãºu±_å™s„r
(
hid_å™s„r
, 
hid
->
h™dÀ
,

680 
hid
->
ídpoöt_ö
,

681 
keybuf
, 
hid
->
∑ckë_size
, 
ˇŒback_hid
,

682 
acc
, 0);

684 
rc
 = 
	`libusb_submô_å™s„r
(
hid_å™s„r
);

685 i‡(
rc
 != 0) {

686 i‡(
rc
)

687 
	`¥ötf
("USBÉº‹ : %s\n", 
	`libusb_îr‹_«me
(
rc
));

688 
	`libusb_˛o£
(
hid
->
h™dÀ
);

693 
	}
}

695 
	$£nd_hid_des¸ùt‹
(
ac˚ss‹y_t
 * 
acc
, 
hid_devi˚
 * 
hid
)

697 
ªt
;

699 
	`¥ötf
("register hid\n");

700 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
, 
LIBUSB_ENDPOINT_OUT
 |

701 
LIBUSB_REQUEST_TYPE_VENDOR
,

702 #ifde‡
TOUCHSCREEN_ENABLE


703 
AOA_REGISTER_HID
, 1, (
hid_ªp‹t_desc
),

705 
AOA_REGISTER_HID
, 1, 
hid
->
des¸ùt‹_size
,

707 
NULL
, 0, 0);

708 i‡(
ªt
 < 0) {

709 
	`¥ötf
("couldn'tÑegister HID device onÅheándroid device : %s\n",

710 
	`libusb_îr‹_«me
(
ªt
));

711 
	`libusb_˛o£
(
hid
->
h™dÀ
);

715 
	`¥ötf
("send hidÑeport\n");

716 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
, 
LIBUSB_ENDPOINT_OUT
 |

717 
LIBUSB_REQUEST_TYPE_VENDOR
,

718 
AOA_SET_HID_REPORT_DESC
, 1, 0,

719 #ifde‡
TOUCHSCREEN_ENABLE


720 
hid_ªp‹t_desc
, (hid_report_desc), 0);

722 
hid
->
des¸ùt‹
, hid->
des¸ùt‹_size
, 0);

724 i‡(
ªt
 < 0) {

725 
	`¥ötf
("couldn't send HID descriptorÅoÅheándroid device\n");

726 
	`libusb_˛o£
(
hid
->
h™dÀ
);

730 
	`±hªad_¸óã
(&
hid
->
rx_thªad
, 
NULL
, 
ª˚ive_lo›
, NULL);

733 
	}
}

	@/opt/resource/linux-adk/src/hid.h

21 #i‚de‡
_HID_H_


22 
	#_HID_H_


	)

24 
	~<±hªad.h
>

28 
libusb_devi˚_h™dÀ
 *
	mh™dÀ
;

29 
	mdes¸ùt‹
[256];

30 
	mdes¸ùt‹_size
;

31 
	mídpoöt_ö
;

32 
ssize_t
 
	m∑ckë_size
;

33 
±hªad_t
 
	mrx_thªad
;

34 } 
	thid_devi˚
;

37 
£nd_hid_des¸ùt‹
(
ac˚ss‹y_t
 *
acc
, 
hid_devi˚
 *
hid
);

38 
ªgi°î_hid_ˇŒback
(
ac˚ss‹y_t
* 
acc
, 
hid_devi˚
 *
hid
);

39 
£¨ch_hid
(
hid_devi˚
 *
hid
);

	@/opt/resource/linux-adk/src/linux-adk.c

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<°dlib.h
>

24 
	~<uni°d.h
>

25 
	~<sig«l.h
>

27 
	~<libusb.h
>

29 
	~"löux-adk.h
"

31 
ac˚ss‹y_maö
(
ac˚ss‹y_t
 * 
acc
);

33 vﬁ©ûê
	g°›_acc
 = 0;

46 c⁄° 
ac˚ss‹y_t
 
	gacc_deÁu…
 = {

47 .
devi˚
 = "2a45:2008",

48 .
	gm™uÁ˘uªr
 = "Hello Inc",

49 .
	gmodñ
 = "HelloWorldModel",

50 .
	gvîsi⁄
 = "2.0",

51 .
	gdes¸ùti⁄
 = "Demo ABS2013",

52 .
	guæ
 = "https://github.com/gibsson",

53 .
	g£rül
 = "0000000012345678",

57 c⁄° 
ac˚ss‹y_t
 
acc_deÁu…
 = {

58 .
devi˚
 = "05c6:901d",

59 .
	gm™uÁ˘uªr
 = "leautolinknetworks",

60 .
	gmodñ
 = "ecolink",

61 .
	gvîsi⁄
 = "01",

62 .
	gdes¸ùti⁄
 = "baby",

63 .
	guæ
 = "https://github.com/gibsson",

64 .
	g£rül
 = "0000000012345678",

69 
is_ac˚ss‹y_¥e£¡
(
ac˚ss‹y_t
 * 
acc
);

70 
öô_ac˚ss‹y
(
ac˚ss‹y_t
 * 
acc
);

71 
föi_ac˚ss‹y
(
ac˚ss‹y_t
 * 
acc
);

73 * 
	$utf8
(c⁄° *
°r
)

75 *
utf8
;

76 
utf8
 = (*)
	`mÆloc
(1+(2*
	`°æí
(
°r
)));

78 i‡(
utf8
) {

79 *
c
 = 
utf8
;

80 ; *
°r
; ++str) {

81 i‡(*
°r
 & 0x80) {

82 *
c
++ = *
°r
;

84 *
c
++ = (Ë(0xc0 | (Ë*
°r
 >> 6);

85 *
c
++ = (Ë(0x80 | (*
°r
 & 0x3f));

88 *
c
++ = '\0';

90  
utf8
;

91 
	}
}

94 
	$sig«l_h™dÀr
(
signo
)

96 
	`¥ötf
("SIGINT: Closingáccessory\n");

97 
°›_acc
 = 1;

98 
	}
}

100 
	$maö
(
¨gc
, *
¨gv
[])

102 
¨g_cou¡
 = 1;

103 
no_≠p
 = 0;

104 
ac˚ss‹y_t
 
acc
 = { 
NULL
, NULL, 0, 0, 0, NULL, NULL, NULL, NULL, NULL,

105 
NULL
, NULL

108 i‡(
	`sig«l
(
SIGINT
, 
sig«l_h™dÀr
Ë=
SIG_ERR
)

109 
	`¥ötf
("Cannot setupá signal handler...\n");

112 
¨g_cou¡
 < 
¨gc
) {

113 i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-d") == 0)

114 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--device") == 0)) {

115 
acc
.
devi˚
 = 
¨gv
[++
¨g_cou¡
];

116 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-D") == 0)

117 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--description")

119 
acc
.
des¸ùti⁄
 = 
¨gv
[++
¨g_cou¡
];

120 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-m") == 0)

121 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--manufacturer")

123 
acc
.
m™uÁ˘uªr
 = 
¨gv
[++
¨g_cou¡
];

124 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-M") == 0)

125 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--model") == 0)) {

126 
acc
.
modñ
 = 
¨gv
[++
¨g_cou¡
];

127 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-n") == 0)

128 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--versionnumber")

130 
acc
.
vîsi⁄
 = 
¨gv
[++
¨g_cou¡
];

131 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-N") == 0)

132 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--no_app") == 0)) {

133 
no_≠p
 = 1;

134 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-s") == 0)

135 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--serial") == 0)) {

136 
acc
.
£rül
 = 
¨gv
[++
¨g_cou¡
];

137 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-u") == 0)

138 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--url") == 0)) {

139 
acc
.
uæ
 = 
¨gv
[++
¨g_cou¡
];

140 } i‡((
	`°rcmp
(
¨gv
[
¨g_cou¡
], "-v") == 0)

141 || (
	`°rcmp
(
¨gv
[
¨g_cou¡
], "--version") == 0)) {

143 
	`exô
(1);

146 
	`exô
(1);

148 
¨g_cou¡
++;

152 i‡(!
acc
.
devi˚
)

153 
acc
.
devi˚
 = 
acc_deÁu…
.device;

154 i‡(!
acc
.
des¸ùti⁄
)

155 
acc
.
des¸ùti⁄
 = 
acc_deÁu…
.description;

156 i‡(!
acc
.
m™uÁ˘uªr
 && !
no_≠p
)

157 
acc
.
m™uÁ˘uªr
 = 
acc_deÁu…
.manufacturer;

158 i‡(!
acc
.
modñ
 && !
no_≠p
)

159 
acc
.
modñ
 = 
acc_deÁu…
.model;

160 i‡(!
acc
.
vîsi⁄
)

161 
acc
.
vîsi⁄
 = 
acc_deÁu…
.version;

162 i‡(!
acc
.
£rül
)

163 
acc
.
£rül
 = 
acc_deÁu…
.serial;

164 i‡(!
acc
.
uæ
)

165 
acc
.
uæ
 = 
acc_deÁu…
.url;

167 i‡(
	`öô_ac˚ss‹y
(&
acc
) != 0)

168 
íd
;

170 
	`ac˚ss‹y_maö
(&
acc
);

172 
íd
:

173 
	`föi_ac˚ss‹y
(&
acc
);

175 
	}
}

177 
	$öô_ac˚ss‹y
(
ac˚ss‹y_t
 * 
acc
)

179 
ªt
;

180 
uöt16_t
 
pid
, 
vid
;

181 *
tmp
;

182 
uöt8_t
 
buf„r
[2];

183 
åõs
 = 1;

186 
ªt
 = 
	`libusb_öô
(
NULL
);

187 i‡(
ªt
 != 0) {

188 
	`¥ötf
("libusb inô faûed: %d\n", 
ªt
);

189  
ªt
;

192 
	`∑r£_devs
(
vid
);

196 i‡(
	`is_ac˚ss‹y_¥e£¡
(
acc
))

200 
vid
 = (
uöt16_t
Ë
	`°πﬁ
(
acc
->
devi˚
, &
tmp
, 16);

201 
pid
 = (
uöt16_t
Ë
	`°πﬁ
(
tmp
 + 1, &tmp, 16);

202 
	`¥ötf
("Lookög f‹ devi˚ %4.4x:%4.4x\n", 
vid
, 
pid
);

205 
acc
->
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

206 i‡(
acc
->
h™dÀ
 =
NULL
) {

207 
	`¥ötf
("UnableÅo open device...\n");

210 
	`¥ötf
("O≥¿devi˚(%4.4x %4.4xËok\n",
vid
, 
pid
);

213 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

214 
LIBUSB_ENDPOINT_IN
 |

215 
LIBUSB_REQUEST_TYPE_VENDOR
,

216 
AOA_GET_PROTOCOL
, 0, 0, 
buf„r
,

217 (
buf„r
), 0);

218 i‡(
ªt
 < 0) {

219 
	`¥ötf
("Error gettingÖrotocol...\n");

220  
ªt
;

222 
acc
->
aﬂ_vîsi⁄
 = ((
buf„r
[1] << 8) | buffer[0]);

223 
	`¥ötf
("Devi˚ suµ‹t†AOA %d.0!\n", 
acc
->
aﬂ_vîsi⁄
);

227 
	`u¶ìp
(10000);

230 i‡((
acc
->
aﬂ_vîsi⁄
 < 2Ë&& !acc->
m™uÁ˘uªr
) {

231 
	`¥ötf
("Connecting withoután Android App only for AOA 2.0\n");

235 
	`¥ötf
("Sending identificationÅoÅhe device\n");

236 i‡(
acc
->
m™uÁ˘uªr
) {

237 
	`¥ötf
(" sídög m™uÁ˘uªr: %s\n", 
acc
->
m™uÁ˘uªr
);

238 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

239 
LIBUSB_ENDPOINT_OUT


240 | 
LIBUSB_REQUEST_TYPE_VENDOR
,

241 
AOA_SEND_IDENT
, 0,

242 
AOA_STRING_MAN_ID
,

243 
	`utf8
(
acc
->
m™uÁ˘uªr
),

244 
	`°æí
(
acc
->
m™uÁ˘uªr
) + 1, 0);

245 i‡(
ªt
 < 0)

246 
îr‹
;

249 
	`u¶ìp
(10000);

250 i‡(
acc
->
modñ
) {

251 
	`¥ötf
(" sídög modñ: %s\n", 
acc
->
modñ
);

252 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

253 
LIBUSB_ENDPOINT_OUT


254 | 
LIBUSB_REQUEST_TYPE_VENDOR
,

255 
AOA_SEND_IDENT
, 0,

256 
AOA_STRING_MOD_ID
,

257 (
uöt8_t
 *Ë
acc
->
modñ
,

258 
	`°æí
(
acc
->
modñ
) + 1, 0);

259 i‡(
ªt
 < 0)

260 
îr‹
;

265 
	`u¶ìp
(10000);

266 
	`¥ötf
(" sídög des¸ùti⁄: %s\n", 
acc
->
des¸ùti⁄
);

267 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

268 
LIBUSB_ENDPOINT_OUT
 |

269 
LIBUSB_REQUEST_TYPE_VENDOR
,

270 
AOA_SEND_IDENT
, 0, 
AOA_STRING_DSC_ID
,

271 (
uöt8_t
 *Ë
acc
->
des¸ùti⁄
,

272 
	`°æí
(
acc
->
des¸ùti⁄
) + 1, 0);

273 i‡(
ªt
 < 0)

274 
îr‹
;

276 
	`u¶ìp
(10000);

277 
	`¥ötf
(" sídög vîsi⁄: %s\n", 
acc
->
vîsi⁄
);

278 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

279 
LIBUSB_ENDPOINT_OUT
 |

280 
LIBUSB_REQUEST_TYPE_VENDOR
,

281 
AOA_SEND_IDENT
, 0, 
AOA_STRING_VER_ID
,

282 (
uöt8_t
 *Ë
acc
->
vîsi⁄
,

283 
	`°æí
(
acc
->
vîsi⁄
) + 1, 0);

284 i‡(
ªt
 < 0)

285 
îr‹
;

287 
	`u¶ìp
(10000);

288 
	`¥ötf
(" sídög uæ: %s\n", 
acc
->
uæ
);

289 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

290 
LIBUSB_ENDPOINT_OUT
 |

291 
LIBUSB_REQUEST_TYPE_VENDOR
,

292 
AOA_SEND_IDENT
, 0, 
AOA_STRING_URL_ID
,

293 (
uöt8_t
 *Ë
acc
->
uæ
,

294 
	`°æí
(
acc
->
uæ
) + 1, 0);

295 i‡(
ªt
 < 0)

296 
îr‹
;

298 
	`u¶ìp
(10000);

299 
	`¥ötf
(" sídög sîü»numbî: %s\n", 
acc
->
£rül
);

300 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

301 
LIBUSB_ENDPOINT_OUT
 |

302 
LIBUSB_REQUEST_TYPE_VENDOR
,

303 
AOA_SEND_IDENT
, 0, 
AOA_STRING_SER_ID
,

304 (
uöt8_t
 *Ë
acc
->
£rül
,

305 
	`°æí
(
acc
->
£rül
) + 1, 0);

306 i‡(
ªt
 < 0)

307 
îr‹
;

310 i‡(
acc
->
aﬂ_vîsi⁄
 >= 2) {

311 
	`¥ötf
("ásking foráudio support\n");

312 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

313 
LIBUSB_ENDPOINT_OUT


314 | 
LIBUSB_REQUEST_TYPE_VENDOR
,

315 
AOA_AUDIO_SUPPORT
, 1, 0, 0, 0, 0);

316 i‡(
ªt
 < 0)

317 
îr‹
;

321 
	`u¶ìp
(20000);

322 
	`¥ötf
("TurningÅhe device in Accessory mode ...");

323 
ªt
 = 
	`libusb_c⁄åﬁ_å™s„r
(
acc
->
h™dÀ
,

324 
LIBUSB_ENDPOINT_OUT
 |

325 
LIBUSB_REQUEST_TYPE_VENDOR
,

326 
AOA_START_ACCESSORY
, 0, 0, 
NULL
, 0, 0);

327 i‡(
ªt
 < 0) {

328 
	`¥ötf
("failed\n");

329 
îr‹
;

333 
	`u¶ìp
(20000);

335 
åõs
 = 2;

337 
åõs
--) {

338 i‡(
	`is_ac˚ss‹y_¥e£¡
(
acc
))

342 
	`¶ìp
(1);

346 
	`›í_•ecül_vid_dev
(
vid
, 
ac˚ss‹y_t
 * 
acc
);

347 
ªt
 = 
	`›í_•ecül_vid_dev
(
AOA_ACCESSORY_VID
,
acc
);

348 if(
ªt
 != 0 ) {

349 
	`¥ötf
("open_special_vid_dev failed\n");

355 
îr‹
:

356 
	`¥ötf
("Ac˚ss‹y inô faûed: %d\n", 
ªt
);

358 
	}
}

361 
	$is_ac˚ss‹y_¥e£¡
(
ac˚ss‹y_t
 * 
acc
)

363 
	`¥ötf
("is_accessory_present ..\n");

364 
libusb_devi˚_h™dÀ
 *
h™dÀ
;

365 
uöt16_t
 
vid
 = 
AOA_ACCESSORY_VID
;

366 
uöt16_t
 
pid
 = 0;

368 
	`¥ötf
("open AOA_ACCESSORY_PID ...");

370 
pid
 = 
AOA_ACCESSORY_PID
;

371 
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

372 i‡(
h™dÀ
 !
NULL
)

373 
˛aim
;

376 
pid
 = 
AOA_ACCESSORY_ADB_PID
;

377 
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

378 i‡(
h™dÀ
 !
NULL
)

379 
˛aim
;

381 
pid
 = 
AOA_AUDIO_PID
;

382 
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

383 i‡(
h™dÀ
 !
NULL
)

384 
˛aim
;

386 
pid
 = 
AOA_AUDIO_ADB_PID
;

387 
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

388 i‡(
h™dÀ
 !
NULL
)

389 
˛aim
;

391 
pid
 = 
AOA_ACCESSORY_AUDIO_PID
;

392 
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

393 i‡(
h™dÀ
 !
NULL
)

394 
˛aim
;

396 
pid
 = 
AOA_ACCESSORY_AUDIO_ADB_PID
;

397 
h™dÀ
 = 
	`libusb_›í_devi˚_wôh_vid_pid
(
NULL
, 
vid
, 
pid
);

398 i‡(
h™dÀ
 !
NULL
)

399 
˛aim
;

401 
	`¥ötf
("notÖresent\n");

404 
˛aim
:

405 
	`¥ötf
("Foundác˚ss‹y %4.4x:%4.4x\n", 
vid
, 
pid
);

406 
acc
->
h™dÀ
 = handle;

407 
acc
->
vid
 = vid;

408 
acc
->
pid
 =Öid;

410 
	}
}

412 
	$föi_ac˚ss‹y
(
ac˚ss‹y_t
 * 
acc
)

414 
	`¥ötf
("Closing USB device\n");

416 i‡(
acc
->
h™dÀ
 !
NULL
) {

417 
	`libusb_ªÀa£_öãrÁ˚
(
acc
->
h™dÀ
, 0);

418 
	`libusb_˛o£
(
acc
->
h™dÀ
);

421 
	`libusb_exô
(
NULL
);

424 
	}
}

	@/opt/resource/linux-adk/src/linux-adk.h

21 #i‚de‡
_LINUX_ADK_H_


22 
	#_LINUX_ADK_H_


	)

24 
	~<°döt.h
>

27 
	#AOA_GET_PROTOCOL
 51

	)

28 
	#AOA_SEND_IDENT
 52

	)

29 
	#AOA_START_ACCESSORY
 53

	)

30 
	#AOA_REGISTER_HID
 54

	)

31 
	#AOA_UNREGISTER_HID
 55

	)

32 
	#AOA_SET_HID_REPORT_DESC
 56

	)

33 
	#AOA_SEND_HID_EVENT
 57

	)

34 
	#AOA_AUDIO_SUPPORT
 58

	)

37 
	#AOA_STRING_MAN_ID
 0

	)

38 
	#AOA_STRING_MOD_ID
 1

	)

39 
	#AOA_STRING_DSC_ID
 2

	)

40 
	#AOA_STRING_VER_ID
 3

	)

41 
	#AOA_STRING_URL_ID
 4

	)

42 
	#AOA_STRING_SER_ID
 5

	)

45 
	#AOA_ACCESSORY_VID
 0x18D1

	)

46 
	#AOA_ACCESSORY_PID
 0x2D00

	)

47 
	#AOA_ACCESSORY_ADB_PID
 0x2D01

	)

48 
	#AOA_AUDIO_PID
 0x2D02

	)

49 
	#AOA_AUDIO_ADB_PID
 0x2D03

	)

50 
	#AOA_ACCESSORY_AUDIO_PID
 0x2D04

	)

51 
	#AOA_ACCESSORY_AUDIO_ADB_PID
 0x2D05

	)

54 
	#AOA_ACCESSORY_EP_IN
 0x81

	)

55 
	#AOA_ACCESSORY_EP_OUT
 0x02

	)

56 
	#AOA_ACCESSORY_INTERFACE
 0x00

	)

59 
	#PACKAGE_VERSION
 "0.3"

	)

60 
	#PACKAGE_BUGREPORT
 "biss⁄.g¨y@gmaû.com"

	)

63 vﬁ©ûê
°›_acc
;

66 
	s_ac˚ss‹y_t
 {

67 
libusb_devi˚_h™dÀ
 *
	mh™dÀ
;

68 
libusb_å™s„r
 *
	må™s„r
;

69 
uöt32_t
 
	maﬂ_vîsi⁄
;

70 
uöt16_t
 
	mvid
;

71 
uöt16_t
 
	mpid
;

72 *
	mdevi˚
;

73 *
	mm™uÁ˘uªr
;

74 *
	mmodñ
;

75 *
	mdes¸ùti⁄
;

76 *
	mvîsi⁄
;

77 *
	muæ
;

78 *
	m£rül
;

79 } 
	tac˚ss‹y_t
;

	@axis.h

8 #i‚de‡
_AXIS_H


9 
	#_AXIS_H


	)

13 
	#PI
 (3.1415926)

	)

16 
	mTOUCH_DOWN
 = 5,

17 
	mTOUCH_MOVE
 = 4,

18 
	mTOUCH_UP
 = 6,

19 } 
	gC¨A˘i⁄
;

23 
	mx
;

24 
	my
;

25 } 
	tPoöt
;

29 
	mba£_x
;

30 
	mba£_y
;

31 
	mvõw_height
;

32 
	mvõw_width
;

33 
	mfuŒ_height
;

34 
	mfuŒ_width
;

35 } 
	tC¨S¸ìnSëtög
;

39 
	mfuŒ_height
;

40 
	mfuŒ_width
;

41 } 
	tPh⁄eS¸ìnSëtög
;

45 
C¨S¸ìnSëtög
 
	mcss
;

46 
Ph⁄eS¸ìnSëtög
 
	mpss
;

47 } 
	tAxisSëtög
 ;

55 
axis_öô
(
AxisSëtög
* 
as
 , 
™gÀ
);

61 
Poöt
 
axis_c⁄vît
(Poöà
p
);

68 
axis_öje˘
(
a˘i⁄
, 
Poöt
 
p
);

	@hid.h

21 #i‚de‡
_HID_H_


22 
	#_HID_H_


	)

24 
	~<±hªad.h
>

28 
libusb_devi˚_h™dÀ
 *
	mh™dÀ
;

29 
	mdes¸ùt‹
[256];

30 
	mdes¸ùt‹_size
;

31 
	mídpoöt_ö
;

32 
ssize_t
 
	m∑ckë_size
;

33 
±hªad_t
 
	mrx_thªad
;

34 } 
	thid_devi˚
;

37 
£nd_hid_des¸ùt‹
(
ac˚ss‹y_t
 *
acc
, 
hid_devi˚
 *
hid
);

38 
ªgi°î_hid_ˇŒback
(
ac˚ss‹y_t
* 
acc
, 
hid_devi˚
 *
hid
);

39 
£¨ch_hid
(
hid_devi˚
 *
hid
);

	@linux-adk.h

21 #i‚de‡
_LINUX_ADK_H_


22 
	#_LINUX_ADK_H_


	)

24 
	~<°döt.h
>

27 
	#AOA_GET_PROTOCOL
 51

	)

28 
	#AOA_SEND_IDENT
 52

	)

29 
	#AOA_START_ACCESSORY
 53

	)

30 
	#AOA_REGISTER_HID
 54

	)

31 
	#AOA_UNREGISTER_HID
 55

	)

32 
	#AOA_SET_HID_REPORT_DESC
 56

	)

33 
	#AOA_SEND_HID_EVENT
 57

	)

34 
	#AOA_AUDIO_SUPPORT
 58

	)

37 
	#AOA_STRING_MAN_ID
 0

	)

38 
	#AOA_STRING_MOD_ID
 1

	)

39 
	#AOA_STRING_DSC_ID
 2

	)

40 
	#AOA_STRING_VER_ID
 3

	)

41 
	#AOA_STRING_URL_ID
 4

	)

42 
	#AOA_STRING_SER_ID
 5

	)

45 
	#AOA_ACCESSORY_VID
 0x18D1

	)

46 
	#AOA_ACCESSORY_PID
 0x2D00

	)

47 
	#AOA_ACCESSORY_ADB_PID
 0x2D01

	)

48 
	#AOA_AUDIO_PID
 0x2D02

	)

49 
	#AOA_AUDIO_ADB_PID
 0x2D03

	)

50 
	#AOA_ACCESSORY_AUDIO_PID
 0x2D04

	)

51 
	#AOA_ACCESSORY_AUDIO_ADB_PID
 0x2D05

	)

54 
	#AOA_ACCESSORY_EP_IN
 0x81

	)

55 
	#AOA_ACCESSORY_EP_OUT
 0x02

	)

56 
	#AOA_ACCESSORY_INTERFACE
 0x00

	)

59 
	#PACKAGE_VERSION
 "0.3"

	)

60 
	#PACKAGE_BUGREPORT
 "biss⁄.g¨y@gmaû.com"

	)

63 vﬁ©ûê
°›_acc
;

66 
	s_ac˚ss‹y_t
 {

67 
libusb_devi˚_h™dÀ
 *
	mh™dÀ
;

68 
libusb_å™s„r
 *
	må™s„r
;

69 
uöt32_t
 
	maﬂ_vîsi⁄
;

70 
uöt16_t
 
	mvid
;

71 
uöt16_t
 
	mpid
;

72 *
	mdevi˚
;

73 *
	mm™uÁ˘uªr
;

74 *
	mmodñ
;

75 *
	mdes¸ùti⁄
;

76 *
	mvîsi⁄
;

77 *
	muæ
;

78 *
	m£rül
;

79 } 
	tac˚ss‹y_t
;

	@
1
.
0
11
320
/opt/resource/linux-adk/src/accessory.c
/opt/resource/linux-adk/src/axis.c
/opt/resource/linux-adk/src/axis.h
/opt/resource/linux-adk/src/device.c
/opt/resource/linux-adk/src/hid.c
/opt/resource/linux-adk/src/hid.h
/opt/resource/linux-adk/src/linux-adk.c
/opt/resource/linux-adk/src/linux-adk.h
axis.h
hid.h
linux-adk.h
